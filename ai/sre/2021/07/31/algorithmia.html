<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="https://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1"
  />

  <title>
     MLOps and GPU serverless computing with Algorithmia &middot; AiFi 
  </title>

  
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-2CDTCF0EP6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-2CDTCF0EP6');
  </script>



  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.ico" />

  <!-- RSS -->
  <link
    rel="alternate"
    type="application/rss+xml"
    title="RSS"
    href="/feed.xml"
  />

  <!-- Additional head bits without overriding original head -->
  <style>
    div.chart {
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }
    .line {
  fill: none;
  stroke: steelblue;
  stroke-width: 2px;
}

.grid line {
  stroke: lightgrey;
  stroke-opacity: 0.7;
  shape-rendering: crispEdges;
}

.grid path {
  stroke-width: 0;
}
  </style>
  <script src="https://d3js.org/d3.v4.js"></script>
  <script src="http://bl.ocks.org/mbostock/raw/4061502/0a200ddf998aa75dfdb1ff32e16b680a15e5cb01/box.js"></script>
</head>


  <body class="post">

    <div id="sidebar">
  <header>
    <div class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        AiFi
      </a>
    </div>
    <p class="lead">The official AiFi</p>
  </header>
  <nav id="sidebar-nav-links">
  
    <a class="home-link "
        href="/">Home</a>
  
  

  

  


  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
      <a class="page-link "
          href="/projects.html">Projects and Demos</a>
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  


  


  
    
  

  
    
  

  
    
      <a class="category-link "
          href="/category/ai.html">Artificial Intelligence</a>
    
  

  
    
      <a class="category-link "
          href="/category/cv.html">Computer Vision</a>
    
  

  
    
  

  

  
    
      <a class="category-link "
          href="/category/non-english.html">Tiếng Việt, 日本語</a>
    
  

  
    
      <a class="category-link "
          href="/category/pm.html">Project Management</a>
    
  

  
    
  

  
    
      <a class="category-link "
          href="/category/se.html">Software Engineering</a>
    
  

  
    
  

  
    
      <a class="category-link "
          href="/category/sre.html">Site Reliability Engineering</a>
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>

  <a href="/about.html">About</a>

  

  <nav id="sidebar-icon-links">
  

  <a id="subscribe-link"
     class="icon" title="Subscribe" aria-label="Subscribe"
     href="/feed.xml">
    <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>
  </a>

  
  
  
  

  
    <a id="tags-link"
       class="icon"
       title="Tags" aria-label="Tags"
       href="/tags.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
    </a>
  

  
    <a id="search-link"
       class="icon"
       title="Search" aria-label="Search"
       href="/search.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>
    </a>
  

  <!-- Optional additional links to insert for icons links -->
</nav>

  <p>
  &copy; 2021.
  <a href="/LICENSE.md">MIT License.</a>
</p>

</div>

    <main class="container">
      <header>
  <h1 class="post-title">MLOps and GPU serverless computing with Algorithmia</h1>
</header>
<div class="content">
  <div class="post-meta">
  <span class="post-date">31 Jul 2021</span>
  <span class="post-categories">
    
      &bull;

      
      
      

      
        <a href="/category/ai.html">
          Artificial Intelligence
        </a>
      
    
      &bull;

      
      
      

      
        <a href="/category/sre.html">
          Site Reliability Engineering
        </a>
      
    
  </span>
  <span class="share-page">
    &bull;
    <a href="https://linkedin.com/shareArticle?url=https://wanted2.github.io/ai/sre/2021/07/31/algorithmia.html" target="_blank"><i class="fa fa-linkedin"></i></a>
    <a href="https://twitter.com/intent/tweet?text=MLOps and GPU serverless computing with Algorithmia&url=https://wanted2.github.io/ai/sre/2021/07/31/algorithmia.html&via=&related=" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fab fa-twitter"></i></a>
    <a href="https://facebook.com/sharer.php?u=https://wanted2.github.io/ai/sre/2021/07/31/algorithmia.html" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square"></i></a>
</span>

<span title="Estimated read time">
  
  
    15 mins
  
</span>

</div>

  <div id="table-of-contents">
  <h2>Index</h2>
    <ol id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#what-is-mlops">What is MLOps?</a>
<ol>
<li class="toc-entry toc-h2"><a href="#mlops">MLOps</a></li>
<li class="toc-entry toc-h2"><a href="#a-short-description-about-steps-and-roles-in-machine-learning">A short description about steps and roles in machine learning</a></li>
</ol>
</li>
<li class="toc-entry toc-h1"><a href="#who-needs-mlops">Who needs MLOps?</a></li>
<li class="toc-entry toc-h1"><a href="#gpu-serverless-computing">GPU serverless computing</a>
<ol>
<li class="toc-entry toc-h2"><a href="#an-overview-of-serverless-computing">An overview of serverless computing</a></li>
<li class="toc-entry toc-h2"><a href="#gpu-choices-for-machine-learning">GPU choices for Machine Learning</a></li>
</ol>
</li>
<li class="toc-entry toc-h1"><a href="#algorithmia">Algorithmia</a>
<ol>
<li class="toc-entry toc-h2"><a href="#overview">Overview</a></li>
<li class="toc-entry toc-h2"><a href="#example-face-recognition">Example: Face Recognition</a></li>
</ol>
</li>
<li class="toc-entry toc-h1"><a href="#conclusion">Conclusion</a></li>
<li class="toc-entry toc-h1"><a href="#references">References</a></li>
</ol>
  </div>

  <div class="post-body">
    <p><img src="/assets/img/ml-workflow.png" alt="" />
<em>Figure 1. A traditional ML pipeline with associated roles (data engineer, data scientist, and software engineer)</em></p>

<blockquote>
  <p><em>Machine learning doesn’t create value unless you can deliver models quickly and at scale.</em></p>

  <p><em>Source: <a href="https://algorithmia.com/product">https://algorithmia.com/product</a></em></p>
</blockquote>

<p>Algorithmia [1] is an MLOps platform for deployments of AI solutions, including health care, face recognition, and so on.
The MLOps [2, 3] includes practices to continuous delivery of ML features to an integration software.
It cares steps from data preparation, model selection, training/tuning/testing, and integration to a software system.
Platforms like Algorithmia provides the ease of automatic training and inference for MLOps with GPU serverless computing.
As the need for such platforms is growing [3, 4], I review such a solution in this blog.
<!--more--></p>

<h1 id="what-is-mlops">What is MLOps?</h1>

<h2 id="mlops">MLOps</h2>

<blockquote>
  <p>Continuous software engineering practices, such as DevOps, have emerged in the last decades among many organizations in their operations.
This has resulted in an ability to deploy new features to use whenever their development is completed, which in turn means that systems are updated frequently.
Source: [3]</p>
</blockquote>

<p><strong>MLOps</strong> can be thought of same continuous process for machine learning systems.
Because machine learning solutions which based on algorithms, not merely on software like software, introduces more actions that are specific for ML algorithms.
These ML features are embedded into a larger software system that serves, provides access to, and monitors ML features. 
The model is only a small part of the software, and then the interaction between the machine learning model and the rest of the system must be designed rightly.</p>

<p>In fact, we often train a model in the separation of the software with many data, then pass the pre-trained model to software engineers for further <strong>deployment and integration</strong> to software systems.
The MLOps will be the part of <strong>automatic data preparation, training, tuning and then integration into external softwares</strong>.
It must be done <strong>continuously</strong> in all steps involving training/testing and delivering to integration software.</p>
<h2 id="a-short-description-about-steps-and-roles-in-machine-learning">A short description about steps and roles in machine learning</h2>

<p>Steps in machine learning deployment can be seen in Figure 1.
It involves steps from collecting data from sources (Internet or given providers), data preparations, model selection, hyper-parameter tuning, training/testing, and integration into software systems.</p>

<p>There are several key roles in this system:</p>

<ul>
  <li>
    <p><strong>Software Engineer (SE)</strong> often takes responsibility in <code class="language-plaintext highlighter-rouge">model deployment</code> and <code class="language-plaintext highlighter-rouge">workflow integration</code>.
Model deployment cares about making the inference of a pre-trained model.
Workflow integration cares about integrating the deployment solution into the target software systems.
Therefore, it will be difficult for data scientists or machine learning engineers who care more about data to do this job because they don’t have enough knowledge about the existed software.
A SE who is already familiar with the target systems is then required.</p>
  </li>
  <li>
    <p><strong>Data Engineer (DE)</strong> cares about data preparation, feature engineering (selecting the best features, dimensionality reduction, and so on), and pre-processing for better performance in model inference (and training).</p>
  </li>
  <li>
    <p><strong>Data Scientist (DS)</strong> cares about selecting the best model for problems at hand, tuning hyper-parameters for the optimal model, and training the models.</p>
  </li>
</ul>

<p>This team is multi-disciplinary and multi-cultural: SE follows the traditions of <strong>Software Engineering</strong> field while DE and DS follow the traditions of <strong>Machine Learning</strong>.</p>

<p>What is the culture of <strong>Software Engineering</strong>?
I cite the famous article about professionalism in software engineering of Robert Martin:</p>

<blockquote>
  <p>Professional software developers ship clean, flexible code that works—on time. [5]</p>
</blockquote>

<p>It is quite hard to object against the words from a big star in your field.
So, a SE should ship a <strong>excellent code</strong>, and a SE must write <strong>high-quality code</strong>.
Otherwise, <strong>you are disqualified as a Software Engineer (SE)</strong>.</p>

<p>Quite strict, right?
But SE culture is longer than ML, so it is understandable about their strictness.
If you already chose the school of software engineering, then you must be qualified in many aspects of software development cycles:
You must be fluent in every software development model, waterfall, agile practices, scrum, spiral, and so on.
You must be experienced in programming languages, compilers, architectures, design patterns, object-oriented patterns, databases.
You must have the ability to provide high-quality works in all aspects: documentations (basic designs, UML diagrams, detailed design, …), management, coding, etc.
But finally, all of your SE skills will be built up from one thing: <strong>the code</strong>.
If you cannot write a clean and high-quality code, and it is perhaps that you cannot do any aspect in SE rightly.
For example, if you cannot design a system well, how do you know that you can write a performant code?
It is quite strict, but from the ML view, we only need a SE who can integrate our solutions into the systems.
Maybe the advisors in SE will require you to write some code following nicely written rules, but we only need SE who can integrate our ML models.</p>

<p>Then, <strong>DE and DS $\neq$ SE?</strong>
Sure, in my opinion, DE cares about data, DS cares about models, and both care about algorithms.
Then, <strong>don’t they write code?</strong>
Actually, one of my supervisors in my university asked me about how I think about the role of a researcher.
When I answered that writing a high-quality code, the person concluded that I (and people like me) disqualified as a machine learning scientist.
Now, I’m willing to learn, and I agree that the ML key roles should not be judged using SE rules and SE culture.
If you hear about no-code and low-code solutions, you can understand the idea of the supervisor.
Researchers often use tools like MATLAB (it is not a programming language, but a kind of tool or scientific language) to assemble the blocks into a runnable system, and then they perform experiments in the systems.</p>

<p>Then if someone objects, let’s me ask you about a good architecture design in software engineering: <strong>do you think that an architecture, which blurs the boundary between the features of different roles like ML and SE is a good software design?</strong>
Consider a design in which SE roles are affected by ML features and ML roles are affected by SE culture.
Is it good enough?
Would a deadlock happen when running parallel?
The SE role in Figure 1 is a bridge between two teams in the system and must be selected carefully by both fields.</p>
<h1 id="who-needs-mlops">Who needs MLOps?</h1>

<p>An official survey titled <em>The State of ML 2020 survey</em> was conducted online in May 2020 [3].
The participants were asked about the needs of MLOps in their software products.
Many participants were sourced from many online sources: the Valohai community, the Data Science Weekly newsletter, and LinkedIn.
A notable conclusion was</p>
<blockquote>
  <p>A tendency to have individuals who are concerned about both infrastructure and models, in contrast to only focusing on models or data as such and overlooking the delivery and deployment part.</p>
</blockquote>

<p>It might be a trend from now, where organizations who care about both models and infrastructures will care more about MLOps.
Nearly 65% of responses also showed their interests in AutoML and production ML.</p>

<h1 id="gpu-serverless-computing">GPU serverless computing</h1>

<h2 id="an-overview-of-serverless-computing">An overview of serverless computing</h2>

<blockquote>
  <p>Serverless is a cloud running model that enables a simpler, more cost-effective way to build and operate cloud-native applications.
Source: <a href="https://www.ibm.com/cloud/learn/serverless">IBM</a></p>
</blockquote>

<p>There are many players in serverless computing now.
Amazon Web Service Lambda, Google Cloud Platform Function, and Microsoft Azure Function, to name a few.
Serverless is a cloud computing model that provisions computing resources on-demand, and offloads all responsibility for common infrastructure management tasks (e.g., scaling, scheduling, patching, provisioning, etc.) to cloud providers and tools, allowing engineers to focus their time and effort on the business logic specific to their applications or process.</p>

<p>According to IBM, there are several key distinctions between serverless computing and the conventional approaches:</p>

<ul>
  <li>The serverless model requires no management and operation of infrastructure, <strong>giving developers more time to optimize code and develop innovative new features and functionality</strong>.</li>
  <li>Serverless computing runs code <strong>on-demand only</strong>, typically in a stateless container, on a per-request basis, and scales transparently with the number of requests being served.</li>
  <li>Serverless computing enables end-users to pay only for resources being used, <strong>never paying for idle capacity</strong>.</li>
</ul>

<h2 id="gpu-choices-for-machine-learning">GPU choices for Machine Learning</h2>

<p><strong>Graphical Processing Unit (GPU)</strong> may be the most demanded option for speeding up AI inference.
GPU serverless computing has several options:</p>

<ul>
  <li><a href="https://azure.microsoft.com/en-us/pricing/details/container-instances/"><strong>Azure Container Instances</strong></a> supports GPU containers from March 2021.</li>
  <li><a href="https://cloud.google.com/compute/gpus-pricing">GCP Compute Engine</a> supports GPU but not in serverless pricing models. Then you will need to run the instances for a long time, and you must pay for even not service time (no requests).</li>
  <li><a href="https://cloud.google.com/run/pricing">Google Cloud Run</a>, which is similar to Azure Container Instances and AWS Fargate ECS, also does not have a pricing model for GPU.</li>
  <li><a href="https://aws.amazon.com/fargate/pricing/">AWS Fargate ECS</a> does not support GPU by now (see <a href="https://github.com/aws/containers-roadmap/issues/88">AWS container roadmap issue #88</a>). You may use ECS for EC2 and select instances which support GPU like g4.</li>
  <li>And <a href="https://aws.amazon.com/lambda/">AWS Lambda</a> does not have GPU now. It is similar to <a href="https://cloud.google.com/functions/">Google Cloud Functions</a> and <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-overview">Azure Functions</a>.</li>
</ul>

<p>So an alternative to Algorithmia should be <strong>Azure Container Instances (ACI)</strong> which is similar to AWS Fargate ECS but supports GPU.</p>

<h1 id="algorithmia">Algorithmia</h1>

<h2 id="overview">Overview</h2>
<p>Algorithmia resides many user algorithms at their side.
A user creates an algorithm and uploads data to their server.
The algorithm will be run through API calls to the selected runtime.
Runtimes often include Python and NVIDIA GPU with several AI frameworks like Tensorflow and PyTorch. 
To perform inference in a client device such as a PC, users need to install client libraries for corresponding client languages, including Python, Ruby, Javascript, and so on.</p>

<p>To start using the service, head to [1] and register an account.
We recommend using the Teams feature as you may need to work in a team.
After finishing the registration, you may see a screen like this:</p>

<p><img src="/assets/img/mlops/algorithmia000.png" alt="" /></p>

<p>There are several tabs in the sidebar, but we pay attention to the <code class="language-plaintext highlighter-rouge">Algorithms</code> and <code class="language-plaintext highlighter-rouge">API Keys</code> tabs.
In <code class="language-plaintext highlighter-rouge">API Keys</code> tab, you may find the API keys for your deployments.
Coming back to <code class="language-plaintext highlighter-rouge">Algorithms</code> tab, click to <code class="language-plaintext highlighter-rouge">Create an algorithm</code> to start your journey.</p>

<p><img src="/assets/img/mlops/algorithmia001.png" alt="" /></p>

<p>In the next screen, you need to input information:</p>

<ul>
  <li>
    <p><strong>Algorithm name</strong>: select an informative name that represents the intention of your algorithm.</p>
  </li>
  <li>
    <p><strong>Container</strong>: select the appropriate runtime environments for your deployment. You can choose between Python or the R language, and runtimes like the <code class="language-plaintext highlighter-rouge">Python 3.8 + PyTorch 1.8.x</code>. It already comes with GPU.</p>
  </li>
  <li>
    <p><strong>Internet access and pipelining</strong>: select whether your solution needs to access the Internet during runtime or call other algorithms.</p>
  </li>
</ul>

<p>After creating the algorithm, you will be redirected to a new screen:</p>

<p><img src="/assets/img/mlops/algorithmia002.png" alt="" /></p>

<p>You can even clone the source code repo using Git:</p>

<p><img src="/assets/img/mlops/algorithmia003.png" alt="" /></p>

<p>You can also edit your code in the browser using <code class="language-plaintext highlighter-rouge">Source code</code> horizontal tab:</p>

<p><img src="/assets/img/mlops/algorithmia004.png" alt="" /></p>

<h2 id="example-face-recognition">Example: Face Recognition</h2>

<p>Face Recognition is a high-class technology that is used in security and dating apps.
In Algorithmia [1], we already have a ready-to-use solution <a href="https://algorithmia.com/algorithms/cv/FaceRecognition/docs"><code class="language-plaintext highlighter-rouge">cv/face_recognition</code></a> [6].
The deployed solution is based on the OpenFace algorithm [7]. 
The algorithm is quite famous, and explaining it in detail is out-of-scope of this blog.
But a brief explanation is available: the algorithm is trained in a set of human facial identities, each has several images.
Then in testing, it takes a face image and tells us who is in the picture with confidence probability.</p>

<p>To do this, we will call the ready solution from a client.
We need to go to the API tab in Algorithmia Teams Console to find the <code class="language-plaintext highlighter-rouge">API Key</code>.
We will need it to fill a placeholder in the code.
Since this is only an investigation for GPU serverless services, then we don’t need to write our own code.
Then only grab some official sample code from Algorithmia (<a href="https://github.com/algorithmiaio/sample-apps/blob/develop/recipes/face_recognition/face_recognition.py">https://github.com/algorithmiaio/sample-apps/blob/develop/recipes/face_recognition/face_recognition.py</a>):</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">Algorithmia</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">Algorithmia</span><span class="p">.</span><span class="n">client</span><span class="p">(</span><span class="s">"YOUR_API_KEY"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_images</span><span class="p">():</span>
    <span class="s">"""Create labeled dataset from data collection."""</span>
    <span class="n">image_dir</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="nb">dir</span><span class="p">(</span><span class="s">"data://your_username/your_data_collection/"</span><span class="p">)</span>
    <span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Retrieve images from data collection.
</span>    <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">image_dir</span><span class="p">.</span><span class="nb">list</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">image_dir</span><span class="p">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="n">path</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'_'</span><span class="p">)</span>
            <span class="n">first_name</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'_'</span><span class="p">)[</span><span class="mi">2</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">'/'</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">last_name</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="c1"># Create label from image name.
</span>            <span class="n">label</span> <span class="o">=</span> <span class="n">first_name</span> <span class="o">+</span> <span class="s">" "</span> <span class="o">+</span> <span class="n">last_name</span>
            <span class="c1"># Label image based on celebrity.
</span>            <span class="n">images</span><span class="p">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">{</span><span class="s">"url"</span><span class="p">:</span> <span class="s">"data://{0}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="nb">file</span><span class="p">.</span><span class="n">path</span><span class="p">),</span> <span class="s">"person"</span><span class="p">:</span> <span class="n">label</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">image_dir</span><span class="p">.</span><span class="n">create</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">images</span>


<span class="k">def</span> <span class="nf">facial_recognition_algorithm</span><span class="p">(</span><span class="nb">input</span><span class="p">):</span>
    <span class="s">"""Call Face Recognition algorithm and pipe input in."""</span>
    <span class="n">algo</span> <span class="o">=</span> <span class="n">client</span><span class="p">.</span><span class="n">algo</span><span class="p">(</span><span class="s">'cv/FaceRecognition/0.2.0'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">algo</span><span class="p">.</span><span class="n">pipe</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">train_images</span><span class="p">():</span>
    <span class="s">"""Train images from celebrity pictures."""</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">get_images</span><span class="p">()</span>
    <span class="nb">input</span> <span class="o">=</span> <span class="p">{</span><span class="s">"action"</span><span class="p">:</span> <span class="s">"add_images"</span><span class="p">,</span>
             <span class="s">"data_collection"</span><span class="p">:</span> <span class="s">"CelebClassifiers"</span><span class="p">,</span>
             <span class="s">"name_space"</span><span class="p">:</span> <span class="s">"WWCelebrities"</span><span class="p">,</span>
             <span class="s">"images"</span><span class="p">:</span> <span class="n">images</span>
             <span class="p">}</span>

    <span class="k">return</span> <span class="n">facial_recognition_algorithm</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">model_predictions</span><span class="p">():</span>
    <span class="s">"""Predict unseen images as a celebrity the model was trained on."""</span>
    <span class="nb">input</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"name_space"</span><span class="p">:</span> <span class="s">"WWCelebrities"</span><span class="p">,</span>
        <span class="s">"data_collection"</span><span class="p">:</span> <span class="s">"CelebClassifiers"</span><span class="p">,</span>
        <span class="s">"action"</span><span class="p">:</span> <span class="s">"predict"</span><span class="p">,</span>
        <span class="s">"images"</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s">"url"</span><span class="p">:</span> <span class="s">"data://your_username/your_data_collection/Anna_Paquin_test.jpg"</span><span class="p">,</span>
                <span class="s">"output"</span><span class="p">:</span> <span class="s">"data://your_username/your_data_collection/Anna_Paquin_test_output.jpg"</span>
            <span class="p">},</span>

            <span class="p">{</span>
                <span class="s">"url"</span><span class="p">:</span> <span class="s">"data://your_username/your_data_collection/Diego_Oppenheimer_1.jpg"</span><span class="p">,</span>
                <span class="s">"output"</span><span class="p">:</span> <span class="s">"data://your_username/your_data_collection/Diego_Oppenheimer_output.jpg"</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s">"url"</span><span class="p">:</span> <span class="s">"data://your_username/your_data_collection/Kenny_Daniel_1.jpg"</span><span class="p">,</span>
                <span class="s">"output"</span><span class="p">:</span> <span class="s">"data://your_username/your_data_collection/Kenny_Daniel_output.jpg"</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s">"url"</span><span class="p">:</span> <span class="s">"data://your_username/your_data_collection/Jon_Peck_1.jpg"</span><span class="p">,</span>
                <span class="s">"output"</span><span class="p">:</span> <span class="s">"data://your_username/your_data_collection/Jon_Peck_output.jpg"</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s">"url"</span><span class="p">:</span> <span class="s">"data://your_username/your_data_collection/Nelsan_Ellis_test.jpg"</span><span class="p">,</span>
                <span class="s">"output"</span><span class="p">:</span> <span class="s">"data://your_username/your_data_collection/Nelsan_Ellis_test_output.jpg"</span>
            <span class="p">}</span>

        <span class="p">]</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">facial_recognition_algorithm</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">train_images</span><span class="p">()</span>
    <span class="n">model_predictions</span><span class="p">()</span>
</code></pre></div></div>

<p>Let’s explain the code.
Function <code class="language-plaintext highlighter-rouge">get_images</code> will load images from hosted data storage [8] inside Algorithmia (then it will be fast due to I/O speed from internal storage).
The results will be a Python dictionary with image paths and label information.
Function <code class="language-plaintext highlighter-rouge">facial_recognition_algorithm</code> will send the input in JSON format to the server for running (then Internet connection’s a must).
Function <code class="language-plaintext highlighter-rouge">train_images</code> and <code class="language-plaintext highlighter-rouge">model_predictions</code> will do training and testing automatically at Algorithmia side.
To fully run this code, we need the library <code class="language-plaintext highlighter-rouge">algorithmia</code> in the client PC:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pip3 <span class="nb">install </span>algorithmia
</code></pre></div></div>

<p>You can adonly the parameters for better predictions.
With default parameters, I can obtain the predictions from Jimmy Carrey like:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"images"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"predictions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="nl">"bb"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"bottom"</span><span class="p">:</span><span class="w"> </span><span class="mi">196</span><span class="p">,</span><span class="w">
            </span><span class="nl">"left"</span><span class="p">:</span><span class="w"> </span><span class="mi">196</span><span class="p">,</span><span class="w">
            </span><span class="nl">"right"</span><span class="p">:</span><span class="w"> </span><span class="mi">325</span><span class="p">,</span><span class="w">
            </span><span class="nl">"top"</span><span class="p">:</span><span class="w"> </span><span class="mi">67</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="nl">"confidence"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5740970666573434</span><span class="p">,</span><span class="w">
          </span><span class="nl">"person"</span><span class="p">:</span><span class="w"> </span><span class="s2">"jim_carrey"</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"data://cv/face_recognition_example_data/jim_carrey_11.jpg"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"result"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h1 id="conclusion">Conclusion</h1>

<p>We reviewed several options for MLOps with GPU supports.
There is a growing need for MLOps with GPU supports in deploying production Machine Learning solutions.
We also experimented the Algorithmia, a new option for this field.
In the future, we may think about Azure Container Instances (ACI), a more mature solution, which also supports GPU in a serverless duration-based pricing model.</p>

<h1 id="references">References</h1>

<ol class="bibliography"><li><span id="Algorith20:online"><i>Algorithmia - Deploy AI at Scale</i>. https://algorithmia.com/.</span></li>
<li><span id="alla2021mlops">Alla, S., &amp; Adari, S. K. (2021). What Is MLOps? In <i>Beginning MLOps with MLFlow</i> (pp. 79–124). Springer.</span></li>
<li><span id="makinen2021needs">Mäkinen, S., Skogström, H., Laaksonen, E., &amp; Mikkonen, T. (2021). Who Needs MLOps: What Data Scientists Seek to Accomplish and How Can MLOps Help? <i>ArXiv Preprint ArXiv:2103.08942</i>.</span></li>
<li><span id="raj2020edge">Raj, E. (2020). <i>Edge MLOps framework for AIoT applications</i>. Arcada University of Applied Sciences.</span></li>
<li><span id="martin2007professionalism">Martin, R. C. (2007). Professionalism and test-driven development. <i>IEEE Software</i>, <i>24</i>(3), 32–36.</span></li>
<li><span id="FaceReco66:online"><i>Face Recognition - Algorithm by cv - Algorithmia</i>. https://algorithmia.com/algorithms/cv/FaceRecognition/docs.</span></li>
<li><span id="reportsa37:online">Brandon Amos, M. S., Bartosz Ludwiczuk. (2016). <i>OpenFace: A general-purpose face recognition library with mobile applications</i>. http://reports-archive.adm.cs.cmu.edu/anon/anon/2016/CMU-CS-16-118.pdf.</span></li>
<li><span id="HostedDa90:online"><i>Hosted Data - Algorithmia Developer Center</i>. https://algorithmia.com/developers/data/hosted.</span></li></ol>

    



<div class="post-tags">
  
    
    <a href="/tags.html#mlops">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">mlops</span>
    </a>
  
    
    <a href="/tags.html#machine-learning">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">machine learning</span>
    </a>
  
    
    <a href="/tags.html#gpu">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">gpu</span>
    </a>
  
    
    <a href="/tags.html#serverless-computing">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">serverless computing</span>
    </a>
  
    
    <a href="/tags.html#algorithmia">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">algorithmia</span>
    </a>
  
    
    <a href="/tags.html#gpu-serverless-computing">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">gpu serverless computing</span>
    </a>
  
</div>
  </div>

  
  <section class="comments">
    <h2>Comments</h2>
    
  <div id="disqus_thread">
    <button class="disqus-load" onClick="loadDisqusComments()">
      Load Comments
    </button>
  </div>
  <script>

  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW
  *  TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT:s
  *  https://disqus.com/admin/universalcode/#configuration-variables
  */
  var disqus_config = function () {
    this.page.url = "https://wanted2.github.io/ai/sre/2021/07/31/algorithmia.html";
    this.page.identifier = "" ||
                           "https://wanted2.github.io/ai/sre/2021/07/31/algorithmia.html";
  }
  function loadDisqusComments() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//caineng.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  }
  </script>
  <noscript>
    Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript">comments powered by Disqus</a>.
  </noscript>



  </section>

  <section class="related">
  <h2>Related Posts</h2>
  <ul class="posts-list">
    
      <li>
        <h3>
          <a href="/se/sre/2021/12/19/adobe-creative-cloud.html">
            Adobe Creative Cloud: An All-in-One Platform for Creators
            <small>19 Dec 2021</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/non-english/se/pm/2021/12/18/turn-off-electric-before-leaving-why.html">
            なぜ帰宅する前や使用済みの時などに電気を消すべきでしょうか?また，なぜ残業しない方がよいか?
            <small>18 Dec 2021</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/non-english/se/2021/12/10/svelte-and-reset-checkboxes-10years-ago.html">
            Nghịch ngợm Svelte và câu chuyện code JS thuần 10 năm trước
            <small>10 Dec 2021</small>
          </a>
        </h3>
      </li>
    
  </ul>
</section>

</div>

    </main>

    <!-- Optional footer content -->

    <script src="https://kit.fontawesome.com/d0b91d895e.js" crossorigin="anonymous"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [['$','$'], ['\\(','\\)']],
          processEscapes: true
        }
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  </body>
</html>
