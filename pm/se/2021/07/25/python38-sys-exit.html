<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="https://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />

  <!-- Enable responsiveness on mobile devices-->
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=1"
  />

  <title>
     Termination in Python &middot; AiFi 
  </title>

  


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png" />
<link rel="shortcut icon" href="/favicon.ico" />

  <!-- RSS -->
  <link
    rel="alternate"
    type="application/rss+xml"
    title="RSS"
    href="/feed.xml"
  />

  <!-- Additional head bits without overriding original head -->
  <style>
    div.chart {
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }
    .line {
  fill: none;
  stroke: steelblue;
  stroke-width: 2px;
}

.grid line {
  stroke: lightgrey;
  stroke-opacity: 0.7;
  shape-rendering: crispEdges;
}

.grid path {
  stroke-width: 0;
}
  </style>
  <script src="https://d3js.org/d3.v4.js"></script>
  <script src="http://bl.ocks.org/mbostock/raw/4061502/0a200ddf998aa75dfdb1ff32e16b680a15e5cb01/box.js"></script>
</head>


  <body class="post">

    <div id="sidebar">
  <header>
    <div class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        AiFi
      </a>
    </div>
    <p class="lead">This is the pre-publish version of AiFi blog. See final version at https://www.caineng.in</p>
  </header>
  <nav id="sidebar-nav-links">
  
    <a class="home-link "
        href="/">Home</a>
  
  

  

  


  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  


  


  
    
  

  
    
  

  
    
      <a class="category-link "
          href="/category/ai.html">Artificial Intelligence</a>
    
  

  
    
      <a class="category-link "
          href="/category/cv.html">Computer Vision</a>
    
  

  
    
  

  

  
    
      <a class="category-link "
          href="/category/non-english.html">Tiếng Việt, 日本語</a>
    
  

  
    
      <a class="category-link "
          href="/category/pm.html">Project Management</a>
    
  

  
    
      <a class="category-link "
          href="/category/se.html">Software Engineering</a>
    
  

  
    
  

  
    
      <a class="category-link "
          href="/category/sre.html">Site Reliability Engineering</a>
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>

  <a href="/about.html">About</a>

  

  <nav id="sidebar-icon-links">
  

  <a id="subscribe-link"
     class="icon" title="Subscribe" aria-label="Subscribe"
     href="/feed.xml">
    <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>
  </a>

  
  
  
  

  
    <a id="tags-link"
       class="icon"
       title="Tags" aria-label="Tags"
       href="/tags.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
    </a>
  

  
    <a id="search-link"
       class="icon"
       title="Search" aria-label="Search"
       href="/search.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>
    </a>
  

  <!-- Optional additional links to insert for icons links -->
</nav>

  <p>
  &copy; 2021.
  <a href="/LICENSE.md">MIT License.</a>
</p>

</div>

    <main class="container">
      <header>
  <h1 class="post-title">Termination in Python</h1>
</header>
<div class="content">
  <div class="post-meta">
  <span class="post-date">25 Jul 2021</span>
  <span class="post-categories">
    
      &bull;

      
      
      

      
        <a href="/category/pm.html">
          Project Management
        </a>
      
    
      &bull;

      
      
      

      
        <a href="/category/se.html">
          Software Engineering
        </a>
      
    
  </span>
  <span class="share-page">
    &bull;
    <a href="https://linkedin.com/shareArticle?url=https://d1oozge46goiac.cloudfront.net/pm/se/2021/07/25/python38-sys-exit.html" target="_blank"><i class="fa fa-linkedin"></i></a>
    <a href="https://twitter.com/intent/tweet?text=Termination in Python&url=https://d1oozge46goiac.cloudfront.net/pm/se/2021/07/25/python38-sys-exit.html&via=&related=" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fab fa-twitter"></i></a>
    <a href="https://facebook.com/sharer.php?u=https://d1oozge46goiac.cloudfront.net/pm/se/2021/07/25/python38-sys-exit.html" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square"></i></a>
</span>

<span title="Estimated read time">
  
  
    5 mins
  
</span>

</div>

  <div id="table-of-contents">
  <h2>Index</h2>
    <ol id="toc" class="section-nav">
<li class="toc-entry toc-h1"><a href="#what-are-kinds-of-termination-in-python">What are kinds of termination in Python?</a>
<ol>
<li class="toc-entry toc-h2"><a href="#by-the-system-by-extinction-and-starvation">By the system: by Extinction and Starvation</a></li>
<li class="toc-entry toc-h2"><a href="#by-processes-by-addintegration-processes">By processes: by Add/Integration processes</a></li>
</ol>
</li>
<li class="toc-entry toc-h1"><a href="#termination-process">Termination process</a></li>
<li class="toc-entry toc-h1"><a href="#the-final-report">The final report</a></li>
</ol>
  </div>

  <div class="post-body">
    <p><img src="https://upload.wikimedia.org/wikipedia/en/thumb/c/ce/Cython-logo.svg/800px-Cython-logo.svg.png" alt="" />
<em>Source: <a href="https://en.wikipedia.org/wiki/File:Cython-logo.svg">Wikipedia</a></em></p>

<p>Every program will come to its end!</p>

<p>The termination of a Python process can be the result of “murder” by the system (<code class="language-plaintext highlighter-rouge">SIGTERM/SIGKILL</code>), or controlled by the program (using <code class="language-plaintext highlighter-rouge">quit(), exit(), os._exit()</code> or <code class="language-plaintext highlighter-rouge">sys.exit()</code>), or by reducing budget.
When writing code, programmers may need to determine whether to put a line of code to terminate the process.
The termination process itself is complex.
And before terminating, we should remember to make a report, an audit log to summarize the life of the Python process.
<!--more--></p>

<h1 id="what-are-kinds-of-termination-in-python">What are kinds of termination in Python?</h1>

<p>The processes in Python can terminate by themselves or by the system.</p>

<h2 id="by-the-system-by-extinction-and-starvation">By the system: by Extinction and Starvation</h2>

<p>A Python process can be terminated suddenly without notices.
If the system (OS) issued a <code class="language-plaintext highlighter-rouge">kill</code> (<code class="language-plaintext highlighter-rouge">SIGTERM/SIGKILL</code>) command when the process violated some policies of the system, we call it <code class="language-plaintext highlighter-rouge">termination by murder</code> (i. e., the system murdered the process).
To “murder” a process, a Linux system can issue a command like:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">kill</span> <span class="nt">-SIGTERM</span> PID
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">SIGTERM</code> cares about termination processes, saving data to prevent losses, but <code class="language-plaintext highlighter-rouge">SIGKILL</code> doesn’t.
When the system “murders” the processes by <code class="language-plaintext highlighter-rouge">SIGKILL</code>, there will be no saved data!</p>

<p>Another form of sudden termination is <em>starvation</em> but it is not considered as termination.
This happens when the system manager found some processes consuming too many resources, or those processes are not needed anymore.
But the manager cannot “murder” the processes, then they decide to let them alive, but reducing the usage of resources.
In Linux, the manager can use the tool <code class="language-plaintext highlighter-rouge">cpulimit</code> to limit CPU usage by process ID.
To install it in Debian,</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>apt <span class="nb">install </span>cpulimit
</code></pre></div></div>
<p>and to limit CPU usage of a process, say 1999, to less than 50%</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">sudo </span>cpulimit <span class="nt">--pid</span> 1999 <span class="nt">--limit</span> 50
</code></pre></div></div>
<p>Note that this limit CPU usage during runtime, not at the beginning!
Then by this <em>starvation</em> mechanism, we may found some very slow processes in the <code class="language-plaintext highlighter-rouge">top</code> command summaries, but they don’t end!</p>

<h2 id="by-processes-by-addintegration-processes">By processes: by Add/Integration processes</h2>

<p><em>Extinction</em> and <em>starvation</em> patterns of terminations are in control of the system and out of control of the process itself.
Other patterns in this section are about termination defined by the process.
In this section, we will discuss two types of such terminations: <em>addition</em> and <em>integration</em>.</p>

<p>In the <em>termination by addition</em>, a successful child process terminates, and results are returned to a parent process.
Sometimes, calling cleanup handlers or flushing buffers are not needed, and then it is normal to use <code class="language-plaintext highlighter-rouge">os._exit()</code> to terminate the child process.
The computed results and resources consumed by the children will be merged into a more full-fledged member in parent processes.</p>

<p>In the <em>termination by integration</em>, a successful process that completed its computation can be terminated.
Computed results and used resources are returned to be used in other processes of the system.
Then it is normal to use <code class="language-plaintext highlighter-rouge">sys.exit([args])</code> in most of these cases.
Some audithooks can be called here to ensure the integrity of the audit cycle.</p>

<h1 id="termination-process">Termination process</h1>

<p>This section describes the mindset in termination.
The termination process has two different parts: (i) decide whether to terminate a process; (ii) implement the termination in code or by command line.</p>

<p>For the first part, the information about the performance of the process is collected from related programs in the system such as <code class="language-plaintext highlighter-rouge">syslog</code>.
Then a criteria database is established as a baseline.
The scoring model is then created to evaluate the decisions: terminate or not.
Termination rules set are matched with a scoring model to make the final decision.
If the decision is uncertain, then further sensitive analysis may be needed to adjust the criteria and their weights.</p>

<p>When termination is confirmed in the decision, it will be implemented.
Manual closeout like in <em>extinction</em> and <em>starvation</em> can be carried out by system commands.
Automatic termination by coding can be implemented by <code class="language-plaintext highlighter-rouge">quit(), exit(), os._exit()</code> and <code class="language-plaintext highlighter-rouge">sys.exit()</code>.
Note that <code class="language-plaintext highlighter-rouge">quit()</code> and <code class="language-plaintext highlighter-rouge">exit()</code> require site modules to be imported, and they should not be called in production.
<code class="language-plaintext highlighter-rouge">os._exit()</code> is used in child processes only.
<code class="language-plaintext highlighter-rouge">sys.exit()</code> should be preferred in most cases.
Successful processes should call</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>
<p>Coming into the mindset should be: whether the cleanup of data, resources are carried out properly? Were related client processes notified about the termination? Did it determine which records and reports are needed to keep? Were closeups of supports and dependencies scheduled properly?
More items are available and should be used in a checklist.</p>

<h1 id="the-final-report">The final report</h1>

<p>A final report summarizes the lifetime of a process is important for further diagnosis and audits.
If it logged its behavior in the code, then logs can be a good summary.
Nonetheless, a good final report should include the following criteria:</p>

<ol>
  <li><strong>Process performance</strong>: CPU usage and resources information can be monitored and logged.</li>
  <li><strong>Administrative performance</strong>: errors and exceptions, accesses, and other security events may happen during process lifetime.</li>
  <li><strong>Process structure</strong>: the structure of code can be logged for diagnosis.</li>
  <li><strong>Administrative files</strong>: any files and functions that are called or linked into this job should be traceable.</li>
  <li><strong>Techniques</strong>: planning, control, and errors/exception handling techniques should be logged.</li>
</ol>

    



<div class="post-tags">
  
    
    <a href="/tags.html#project-management">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">project management</span>
    </a>
  
    
    <a href="/tags.html#python">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">python</span>
    </a>
  
    
    <a href="/tags.html#exit">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">exit</span>
    </a>
  
    
    <a href="/tags.html#termination">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">termination</span>
    </a>
  
</div>
  </div>

  
  <section class="comments">
    <h2>Comments</h2>
    
  <div id="disqus_thread">
    <button class="disqus-load" onClick="loadDisqusComments()">
      Load Comments
    </button>
  </div>
  <script>

  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW
  *  TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT:s
  *  https://disqus.com/admin/universalcode/#configuration-variables
  */
  var disqus_config = function () {
    this.page.url = "https://d1oozge46goiac.cloudfront.net/pm/se/2021/07/25/python38-sys-exit.html";
    this.page.identifier = "" ||
                           "https://d1oozge46goiac.cloudfront.net/pm/se/2021/07/25/python38-sys-exit.html";
  }
  function loadDisqusComments() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = '//caineng.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  }
  </script>
  <noscript>
    Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript">comments powered by Disqus</a>.
  </noscript>



  </section>

  <section class="related">
  <h2>Related Posts</h2>
  <ul class="posts-list">
    
      <li>
        <h3>
          <a href="/non-english/se/2021/10/08/git-merge-rebase.html">
            So sánh git merge và git rebase
            <small>08 Oct 2021</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/non-english/se/2021/09/27/agile-feature.html">
            アジャイル開発でタスクにアサインされる場合、直ぐにやるかどうかどうやって判定するか？
            <small>27 Sep 2021</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/pm/sre/non-english/2021/09/09/secure-browser.html">
            セキュアブラウザについて
            <small>09 Sep 2021</small>
          </a>
        </h3>
      </li>
    
  </ul>
</section>

</div>

    </main>

    <!-- Optional footer content -->

    <script src="https://kit.fontawesome.com/d0b91d895e.js" crossorigin="anonymous"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [['$','$'], ['\\(','\\)']],
          processEscapes: true
        }
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  </body>
</html>
